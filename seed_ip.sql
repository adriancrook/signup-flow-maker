[dotenv@17.2.3] injecting env (2) from .env.local -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops
-- SQL Seed for individual-parent
-- Flow: Individual Parent
DO $$
DECLARE
  org_id uuid;
  profile_id uuid;
  new_flow_id uuid;
  version_id uuid;
BEGIN
  -- Get IDs
  SELECT id INTO org_id FROM organizations WHERE slug = 'teaching-com';
  SELECT id INTO profile_id FROM profiles WHERE organization_id = org_id LIMIT 1;

  -- Insert Flow
  INSERT INTO flows (organization_id, name, description, created_by)
  VALUES (org_id, 'Individual Parent', 'Imported from Blueprint', profile_id)
  RETURNING id INTO new_flow_id;

  -- Insert Version
  INSERT INTO flow_versions (flow_id, version_name, data, created_by)
  VALUES (new_flow_id, 'Initial Seed', '{"nodes":[{"id":"wntPolh8Kf_gempQEUitG","type":"MC","position":{"x":0,"y":0},"data":{"screen":{"id":"wntPolh8Kf_gempQEUitG","type":"MC","title":"Who are you?","question":"I am a...","options":[{"id":"opt-stu","label":"Student","value":"student"},{"id":"opt-par","label":"Parent","value":"parent"},{"id":"opt-adl","label":"Adult Learner","value":"adult"}],"variableBinding":"role"},"label":"Individual Gatekeeper","code":"MC-GATEKEEPER-IND","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"Q6vEHyy_1KMTJMi9aOUJG","type":"MSG","position":{"x":360,"y":0},"data":{"screen":{"id":"Q6vEHyy_1KMTJMi9aOUJG","type":"MSG","title":"Social Proof","style":"overlay","copy":"You are joining 50 million users who trust Typing.com.","headline":"Great choice!"},"label":"Social Proof","code":"MSG-SOCIAL-PROOF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"0co7UWLfdr-xPDw6Jbxvp","type":"TXT","position":{"x":720,"y":0},"data":{"screen":{"id":"0co7UWLfdr-xPDw6Jbxvp","type":"TXT","title":"Child''s Name","prompt":"What is your child''s first name?","placeholder":"e.g. Noah","inputType":"text","variableBinding":"childName"},"label":"Child''s Name","code":"TXT-CHILDNAME-PAR","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"ysRJH5fl7j1rQ30LS3v-k","type":"MC","position":{"x":1080,"y":0},"data":{"screen":{"id":"ysRJH5fl7j1rQ30LS3v-k","type":"MC","title":"Experience Level","question":"What is your child''s typing experience level?","options":[{"id":"opt-new","label":"Brand New","value":"new"},{"id":"opt-peck","label":"Dabbles / Hunts & Pecks","value":"dabbles"},{"id":"opt-fluent","label":"Fluent","value":"fluent"}],"variableBinding":"experienceLevel"},"label":"Child''s Experience","code":"MC-EXPERIENCE-PAR","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"jkRepkWs4ryRJp1QpVju7","type":"MSG","position":{"x":0,"y":320},"data":{"screen":{"id":"jkRepkWs4ryRJp1QpVju7","type":"MSG","title":"Perfect Match","headline":"Perfect.","copy":"Typing.com has standards-aligned curriculum for every typing level.","style":"standard"},"label":"Experience Confirmed","code":"MSG-EXPERIENCE-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"dQIY0ULki4hPneXZ7v_5a","type":"MC","position":{"x":360,"y":320},"data":{"screen":{"id":"dQIY0ULki4hPneXZ7v_5a","type":"MC","title":"Tech Skills","question":"How would you rate their current Tech Literacy?","options":[{"id":"opt-beg","label":"Beginner/None","value":"beginner"},{"id":"opt-int","label":"Intermediate","value":"intermediate"},{"id":"opt-adv","label":"Advanced","value":"advanced"}],"variableBinding":"techSkillsLevel"},"label":"Tech Skills","code":"MC-TECHSKILLS-PAR","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"AUcEfmuIE-TQCwJc2UVpo","type":"MSG","position":{"x":720,"y":320},"data":{"screen":{"id":"AUcEfmuIE-TQCwJc2UVpo","type":"MSG","title":"Skills Configured","headline":"Excellent.","copy":"Our curriculum is designed specifically to build these future-ready skills, including Beyond Typing modules in our PLUS plan.","style":"standard"},"label":"Skills Confirmed","code":"MSG-TECHSKILLS-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"TfiJGXBwVp1Hc9Zrfv_sG","type":"MC","position":{"x":1080,"y":320},"data":{"screen":{"id":"TfiJGXBwVp1Hc9Zrfv_sG","type":"MC","title":"Screen Time","question":"What is your biggest concern regarding screen time?","options":[{"id":"opt-ads","label":"Exposure to Ads/Tracking","value":"ads"},{"id":"opt-focus","label":"Lack of Focus","value":"focus"},{"id":"opt-waste","label":"Wasting Time","value":"waste"},{"id":"opt-safe","label":"Safety","value":"safety"}],"variableBinding":"screenTimeConcern"},"label":"Screen Time Concern","code":"MC-SCREENTIME-PAR","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"x4TlFJ7FlxAVFsvzbUVFY","type":"MSG","position":{"x":0,"y":640},"data":{"screen":{"id":"x4TlFJ7FlxAVFsvzbUVFY","type":"MSG","title":"Safety First","headline":"Understood.","copy":"That''s why PLUS is 100% Ad-Freeâ€”eliminating distractions for safe, focused learning.","style":"standard"},"label":"Safety Confirmed","code":"MSG-SCREENTIME-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"WQC74vTelmPgPe2ynTRMn","type":"MC","position":{"x":360,"y":640},"data":{"screen":{"id":"WQC74vTelmPgPe2ynTRMn","type":"MC","title":"Barriers","question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}],"variableBinding":"barrier","variants":{"student":{"question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]},"parent":{"question":"What usually stops them from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]},"adult":{"question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]}}},"label":"Barriers","code":"MC-BARRIERS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"-ygcjVcoSq2z6an-BHVGr","type":"MSG","position":{"x":720,"y":640},"data":{"screen":{"id":"-ygcjVcoSq2z6an-BHVGr","type":"MSG","title":"We Get It","headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you focused.","style":"standard","variants":{"student":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you focused."},"parent":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep them focused."},"adult":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you in a ''Flow State''."}}},"label":"Barriers Solution","code":"MSG-BARRIERS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"b0dCiRwap_pNXqZXfl0Nl","type":"MC","position":{"x":1080,"y":640},"data":{"screen":{"id":"b0dCiRwap_pNXqZXfl0Nl","type":"MC","title":"Motivation","question":"What keeps you motivated?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-games","label":"Games","value":"games"},{"id":"opt-track","label":"Progress Tracking","value":"tracking"}],"variableBinding":"motivation","variants":{"student":{"question":"What keeps you motivated when you''re learning?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-games","label":"Games","value":"games"},{"id":"opt-track","label":"Progress Tracking","value":"tracking"}]},"parent":{"question":"What motivates them to learn a new skill?","options":[{"id":"opt-fun","label":"Fun","value":"fun"},{"id":"opt-grades","label":"Grades","value":"grades"},{"id":"opt-rewards","label":"Rewards","value":"rewards"}]},"adult":{"question":"What keeps you motivated when you''re learning?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-certificates","label":"Certificates","value":"certificates"}]}}},"label":"Motivation","code":"MC-MOTIVATION","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"7_MRYRm0da0rAFMA6zwAE","type":"MC","position":{"x":0,"y":960},"data":{"screen":{"id":"7_MRYRm0da0rAFMA6zwAE","type":"MC","title":"Daily Goal","question":"How much time can you commit daily?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}],"variableBinding":"dailyGoal","variants":{"student":{"question":"How much time can you commit to practicing each day?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]},"parent":{"question":"How much time will they be able to use Typing.com?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]},"adult":{"question":"How much time can you commit?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]}}},"label":"Daily Goal","code":"MC-DAILYGOAL","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"Klx8U2UUL7K0hXBWZCb45","type":"MC","position":{"x":360,"y":960},"data":{"screen":{"id":"Klx8U2UUL7K0hXBWZCb45","type":"MC","title":"Discovery","question":"How did you hear about us?","options":[{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-friend","label":"Friend/Colleague","value":"friend"}],"variableBinding":"discoverySource","variants":{"student":{"options":[{"id":"opt-teacher","label":"Teacher","value":"teacher"},{"id":"opt-friend","label":"Friend/Classmate","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"parent":{"options":[{"id":"opt-teacher","label":"Teacher","value":"teacher"},{"id":"opt-friend","label":"Friend/Classmate","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"adult":{"options":[{"id":"opt-coworker","label":"Coworker","value":"coworker"},{"id":"opt-friend","label":"Friend","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"teacher":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]},"school-admin":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]},"district-admin":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]}}},"label":"Discovery","code":"MC-DISCOVERY","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"rIhQpuchmdQ35qUpfh1fF","type":"INT","position":{"x":720,"y":960},"data":{"screen":{"id":"rIhQpuchmdQ35qUpfh1fF","type":"INT","title":"Plan Analysis","headline":"Building Your Plan...","duration":3000,"animation":"progress-bar","messages":[{"text":"Analyzing inputs..."},{"text":"Generating curriculum..."},{"text":"Finalizing..."}],"variants":{"student":{"headline":"Building Your Plan...","messages":[{"text":"Measuring your baseline..."},{"text":"Setting target speed..."},{"text":"Optimizing curriculum..."}]},"parent":{"headline":"Building Plan...","messages":[{"text":"Assessing typing level..."},{"text":"Calibrating tech literacy modules..."},{"text":"Addressing screen time concerns..."}]},"adult":{"headline":"Building Your Plan...","messages":[{"text":"Optimizing for your goal..."},{"text":"Tackling your barriers..."},{"text":"Finalizing roadmap..."}]},"teacher":{"headline":"Building Classroom Plan...","messages":[{"text":"Confirming standards alignment..."},{"text":"Loading curriculum..."},{"text":"Configuring rostering..."}]},"school-admin":{"headline":"Building School Plan...","messages":[{"text":"Scaling for student count..."},{"text":"Securing environment..."},{"text":"Enabling data retention..."}]},"district-admin":{"headline":"Building District Plan...","messages":[{"text":"Mapping schools to dashboard..."},{"text":"Verifying rostering protocols..."},{"text":"Preparing compliance docs..."}]}}},"label":"Plan Analysis","code":"INT-PLAN-ANALYSIS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"Gha4Syo3Cuh2RVqE8uOwJ","type":"FORM","position":{"x":1080,"y":960},"data":{"screen":{"id":"Gha4Syo3Cuh2RVqE8uOwJ","type":"FORM","title":"Create Account","headline":"Your Plan is Ready","copy":"Create details to save your plan.","collectFields":["email","password"],"showSocialLogin":true,"variants":{"student":{"headline":"Your customized typing plan is ready!","copy":"We''ve built a roadmap to help you reach your goal."},"parent":{"headline":"Save your child''s custom plan","copy":"We''ve generated your child''s personalized roadmap."},"adult":{"headline":"Your customized typing plan is ready!","copy":"We''ve built a roadmap to help you reach your goal."},"teacher":{"headline":"Your Classroom is Ready.","copy":"Create your free account to save your classroom settings."},"school-admin":{"headline":"Secure Your School''s Learning Environment.","copy":"Create an account to save your school''s data configuration."},"district-admin":{"headline":"Your Compliant District Plan.","copy":"Solve your privacy requirements and rostering infrastructure today."}}},"label":"Signup Form","code":"FORM-SIGNUP","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"MCOWmKIuhpWSW69vg4uJC","type":"PAY","position":{"x":0,"y":1280},"data":{"screen":{"id":"MCOWmKIuhpWSW69vg4uJC","type":"PAY","title":"PLUS Plan","headline":"Unlock Full Experience","valuePropositions":["Ad-free learning","Unlimited history","Certificates"],"primaryAction":{"label":"Upgrade","action":"upgrade"},"variants":{"student":{"headline":"Unlock the Full Experience","valuePropositions":["Premium Content","Zero Distractions"]},"parent":{"headline":"Unlock the Full Experience for [Child Name]","valuePropositions":["Premium Content","Zero Distractions"]},"adult":{"headline":"Your Typing.com PLUS plan is ready","valuePropositions":["Ad-free learning","Certificates","Unlimited history"]},"teacher":{"headline":"Unlock the Full Classroom Experience","valuePropositions":["Full Coding Curriculum","Ad-free environment","Student progress tracking"]},"school-admin":{"headline":"Your School''s Ad-Free Quote","valuePropositions":["100% Ad-Free Walled Garden","Unlimited Data Retention","School-wide SSO"]},"district-admin":{"headline":"Your District Implementation Roadmap","valuePropositions":["100% Ad-Free Walled Garden","Signed DPA Compliance","District Master Dashboard"]}}},"label":"Plus Paywall","code":"PAY-PLUS","isValid":true,"isSelected":false,"isHighlighted":false}}],"edges":[{"id":"e-wntPolh8Kf_gempQEUitG-Q6vEHyy_1KMTJMi9aOUJG","source":"wntPolh8Kf_gempQEUitG","target":"Q6vEHyy_1KMTJMi9aOUJG","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-Q6vEHyy_1KMTJMi9aOUJG-0co7UWLfdr-xPDw6Jbxvp","source":"Q6vEHyy_1KMTJMi9aOUJG","target":"0co7UWLfdr-xPDw6Jbxvp","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-0co7UWLfdr-xPDw6Jbxvp-ysRJH5fl7j1rQ30LS3v-k","source":"0co7UWLfdr-xPDw6Jbxvp","target":"ysRJH5fl7j1rQ30LS3v-k","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-ysRJH5fl7j1rQ30LS3v-k-jkRepkWs4ryRJp1QpVju7","source":"ysRJH5fl7j1rQ30LS3v-k","target":"jkRepkWs4ryRJp1QpVju7","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-jkRepkWs4ryRJp1QpVju7-dQIY0ULki4hPneXZ7v_5a","source":"jkRepkWs4ryRJp1QpVju7","target":"dQIY0ULki4hPneXZ7v_5a","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-dQIY0ULki4hPneXZ7v_5a-AUcEfmuIE-TQCwJc2UVpo","source":"dQIY0ULki4hPneXZ7v_5a","target":"AUcEfmuIE-TQCwJc2UVpo","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-AUcEfmuIE-TQCwJc2UVpo-TfiJGXBwVp1Hc9Zrfv_sG","source":"AUcEfmuIE-TQCwJc2UVpo","target":"TfiJGXBwVp1Hc9Zrfv_sG","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-TfiJGXBwVp1Hc9Zrfv_sG-x4TlFJ7FlxAVFsvzbUVFY","source":"TfiJGXBwVp1Hc9Zrfv_sG","target":"x4TlFJ7FlxAVFsvzbUVFY","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-x4TlFJ7FlxAVFsvzbUVFY-WQC74vTelmPgPe2ynTRMn","source":"x4TlFJ7FlxAVFsvzbUVFY","target":"WQC74vTelmPgPe2ynTRMn","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-WQC74vTelmPgPe2ynTRMn--ygcjVcoSq2z6an-BHVGr","source":"WQC74vTelmPgPe2ynTRMn","target":"-ygcjVcoSq2z6an-BHVGr","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e--ygcjVcoSq2z6an-BHVGr-b0dCiRwap_pNXqZXfl0Nl","source":"-ygcjVcoSq2z6an-BHVGr","target":"b0dCiRwap_pNXqZXfl0Nl","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-b0dCiRwap_pNXqZXfl0Nl-7_MRYRm0da0rAFMA6zwAE","source":"b0dCiRwap_pNXqZXfl0Nl","target":"7_MRYRm0da0rAFMA6zwAE","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-7_MRYRm0da0rAFMA6zwAE-Klx8U2UUL7K0hXBWZCb45","source":"7_MRYRm0da0rAFMA6zwAE","target":"Klx8U2UUL7K0hXBWZCb45","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-Klx8U2UUL7K0hXBWZCb45-rIhQpuchmdQ35qUpfh1fF","source":"Klx8U2UUL7K0hXBWZCb45","target":"rIhQpuchmdQ35qUpfh1fF","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-rIhQpuchmdQ35qUpfh1fF-Gha4Syo3Cuh2RVqE8uOwJ","source":"rIhQpuchmdQ35qUpfh1fF","target":"Gha4Syo3Cuh2RVqE8uOwJ","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-Gha4Syo3Cuh2RVqE8uOwJ-MCOWmKIuhpWSW69vg4uJC","source":"Gha4Syo3Cuh2RVqE8uOwJ","target":"MCOWmKIuhpWSW69vg4uJC","type":"smoothstep","animated":true,"data":{"isDefault":true}}]}'::jsonb, profile_id)
  RETURNING id INTO version_id;

  -- Update Current
  UPDATE flows SET current_version_id = version_id WHERE id = new_flow_id;
END $$;

