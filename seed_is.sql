[dotenv@17.2.3] injecting env (2) from .env.local -- tip: üõ†Ô∏è  run anywhere with `dotenvx run -- yourcommand`
-- SQL Seed for individual-student
-- Flow: Individual Student
DO $$
DECLARE
  org_id uuid;
  profile_id uuid;
  new_flow_id uuid;
  version_id uuid;
BEGIN
  -- Get IDs
  SELECT id INTO org_id FROM organizations WHERE slug = 'teaching-com';
  SELECT id INTO profile_id FROM profiles WHERE organization_id = org_id LIMIT 1;

  -- Insert Flow
  INSERT INTO flows (organization_id, name, description, created_by)
  VALUES (org_id, 'Individual Student', 'Imported from Blueprint', profile_id)
  RETURNING id INTO new_flow_id;

  -- Insert Version
  INSERT INTO flow_versions (flow_id, version_name, data, created_by)
  VALUES (new_flow_id, 'Initial Seed', '{"nodes":[{"id":"1p4dgvlhDf48KAt8T4XUs","type":"MC","position":{"x":0,"y":0},"data":{"screen":{"id":"1p4dgvlhDf48KAt8T4XUs","type":"MC","title":"Who are you?","question":"I am a...","options":[{"id":"opt-stu","label":"Student","value":"student"},{"id":"opt-par","label":"Parent","value":"parent"},{"id":"opt-adl","label":"Adult Learner","value":"adult"}],"variableBinding":"role"},"label":"Individual Gatekeeper","code":"MC-GATEKEEPER-IND","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"slNkS3fVu-zPrEipit7wR","type":"MC","position":{"x":360,"y":0},"data":{"screen":{"id":"slNkS3fVu-zPrEipit7wR","type":"MC","title":"Class Code","question":"Do you have a class code from your teacher?","options":[{"id":"opt-yes","label":"Yes","value":"yes","nextScreenId":"CODE:EXIT-CLASS-CODE"},{"id":"opt-no","label":"No","value":"no"}],"variableBinding":"hasClassCode"},"label":"Class Code Check","code":"MC-CLASSCODE-STU","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"dDKs-GQT6ldAsLDmQuB05","type":"MSG","position":{"x":720,"y":0},"data":{"screen":{"id":"dDKs-GQT6ldAsLDmQuB05","type":"MSG","title":"Social Proof","style":"overlay","copy":"You are joining 50 million users who trust Typing.com.","headline":"Great choice!"},"label":"Social Proof","code":"MSG-SOCIAL-PROOF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"cpHH83eDtkpAXgMfmp1m2","type":"MC","position":{"x":1080,"y":0},"data":{"screen":{"id":"cpHH83eDtkpAXgMfmp1m2","type":"MC","title":"Purpose","question":"Why are you looking to improve your typing today?","options":[{"id":"opt-school","label":"Success in School/College","value":"school"},{"id":"opt-coding","label":"Tech & Coding Interests","value":"coding"},{"id":"opt-fun","label":"Just for Fun & Games","value":"fun"},{"id":"opt-growth","label":"Personal Growth","value":"growth"}],"variableBinding":"purpose","variants":{"student":{"question":"Why are you looking to improve your typing today?","options":[{"id":"opt-school","label":"Success in School/College","value":"school"},{"id":"opt-coding","label":"Tech & Coding Interests","value":"coding"},{"id":"opt-fun","label":"Just for Fun & Games","value":"fun"},{"id":"opt-growth","label":"Personal Growth","value":"growth"}]},"adult":{"question":"What is your primary goal today?","options":[{"id":"opt-technique","label":"I want to learn proper technique from scratch","value":"technique"},{"id":"opt-speed","label":"I want to boost my existing speed and accuracy","value":"speed"},{"id":"opt-test","label":"I just want to take a quick typing test","value":"test"}]}}},"label":"Purpose Assessment","code":"MC-PURPOSE","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"yUt8U3AImSVpCG4Io_bbK","type":"MSG","position":{"x":0,"y":320},"data":{"screen":{"id":"yUt8U3AImSVpCG4Io_bbK","type":"MSG","title":"Great Goal","headline":"Great goal.","copy":"Many students use our premium coding and test prep units to get ahead.","style":"standard"},"label":"Purpose Affirmation","code":"MSG-PURPOSE-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"5adxRo7boxjBL52d26QxB","type":"TEST","position":{"x":360,"y":320},"data":{"screen":{"id":"5adxRo7boxjBL52d26QxB","type":"TEST","title":"Baseline Test","prompt":"Let''s get a baseline. Type the sentence below:","testText":"The quick brown fox jumps over the lazy dog.","minDuration":0,"variableBindings":{"wpm":"currentWpm"}},"label":"Mini Typing Test","code":"TEST-BASELINE-ALL","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"f-sIV1P5n12Wcai1FFjwn","type":"MSG","position":{"x":720,"y":320},"data":{"screen":{"id":"f-sIV1P5n12Wcai1FFjwn","type":"MSG","title":"Baseline Result","headline":"Not bad!","copy":"You clocked in at [Current WPM] WPM. We can 2x that speed with practice.","style":"standard"},"label":"Baseline Result","code":"MSG-BASELINE-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"7DrMka7T2KWBhquDTURvq","type":"MC","position":{"x":1080,"y":320},"data":{"screen":{"id":"7DrMka7T2KWBhquDTURvq","type":"MC","title":"Target Speed","question":"What is your target typing speed?","options":[{"id":"opt-40","label":"40 WPM","value":"40"},{"id":"opt-60","label":"60 WPM","value":"60"},{"id":"opt-80","label":"80 WPM","value":"80"},{"id":"opt-100","label":"100+ WPM","value":"100+"}],"variableBinding":"targetSpeed"},"label":"Target Speed","code":"MC-TARGET-ALL","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"zuMd-bOIk5Rolsg1kGOqi","type":"MSG","position":{"x":0,"y":640},"data":{"screen":{"id":"zuMd-bOIk5Rolsg1kGOqi","type":"MSG","title":"Target Set","headline":"We''ve got you.","copy":"We''ll track your progress every step of the way to ensure you hit that goal.","style":"standard"},"label":"Target Set","code":"MSG-TARGET-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"ChrPCBxsJEcqnJXoueZqp","type":"MC","position":{"x":360,"y":640},"data":{"screen":{"id":"ChrPCBxsJEcqnJXoueZqp","type":"MC","title":"Barriers","question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}],"variableBinding":"barrier","variants":{"student":{"question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]},"parent":{"question":"What usually stops them from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]},"adult":{"question":"What usually stops you from practicing?","options":[{"id":"opt-distract","label":"Distractions/Ads","value":"distractions"},{"id":"opt-bored","label":"Boredom","value":"boredom"},{"id":"opt-time","label":"Lack of Time","value":"time"}]}}},"label":"Barriers","code":"MC-BARRIERS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"rui2FgUCVoTQmENPGW9l3","type":"MSG","position":{"x":720,"y":640},"data":{"screen":{"id":"rui2FgUCVoTQmENPGW9l3","type":"MSG","title":"We Get It","headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you focused.","style":"standard","variants":{"student":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you focused."},"parent":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep them focused."},"adult":{"headline":"We get it.","copy":"That''s why PLUS removes all video ads to keep you in a ''Flow State''."}}},"label":"Barriers Solution","code":"MSG-BARRIERS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"TQLehiHrorIcuv4bZQCcc","type":"MC","position":{"x":1080,"y":640},"data":{"screen":{"id":"TQLehiHrorIcuv4bZQCcc","type":"MC","title":"Motivation","question":"What keeps you motivated?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-games","label":"Games","value":"games"},{"id":"opt-track","label":"Progress Tracking","value":"tracking"}],"variableBinding":"motivation","variants":{"student":{"question":"What keeps you motivated when you''re learning?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-games","label":"Games","value":"games"},{"id":"opt-track","label":"Progress Tracking","value":"tracking"}]},"parent":{"question":"What motivates them to learn a new skill?","options":[{"id":"opt-fun","label":"Fun","value":"fun"},{"id":"opt-grades","label":"Grades","value":"grades"},{"id":"opt-rewards","label":"Rewards","value":"rewards"}]},"adult":{"question":"What keeps you motivated when you''re learning?","options":[{"id":"opt-streaks","label":"Streaks","value":"streaks"},{"id":"opt-certificates","label":"Certificates","value":"certificates"}]}}},"label":"Motivation","code":"MC-MOTIVATION","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"DVkyPMcpTsGcyMZmW_4qW","type":"MSG","position":{"x":0,"y":960},"data":{"screen":{"id":"DVkyPMcpTsGcyMZmW_4qW","type":"MSG","title":"Perfect Match","headline":"Perfect!","copy":"Typing.com uses gamified learning to keep you engaged.","style":"standard"},"label":"Motivation Confirmed","code":"MSG-MOTIVATION-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"LZogZSwjq10HfDEhyvMMS","type":"MC","position":{"x":360,"y":960},"data":{"screen":{"id":"LZogZSwjq10HfDEhyvMMS","type":"MC","title":"Discovery","question":"How did you hear about us?","options":[{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-friend","label":"Friend/Colleague","value":"friend"}],"variableBinding":"discoverySource","variants":{"student":{"options":[{"id":"opt-teacher","label":"Teacher","value":"teacher"},{"id":"opt-friend","label":"Friend/Classmate","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"parent":{"options":[{"id":"opt-teacher","label":"Teacher","value":"teacher"},{"id":"opt-friend","label":"Friend/Classmate","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"adult":{"options":[{"id":"opt-coworker","label":"Coworker","value":"coworker"},{"id":"opt-friend","label":"Friend","value":"friend"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"}]},"teacher":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]},"school-admin":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]},"district-admin":{"options":[{"id":"opt-colleague","label":"Colleague","value":"colleague"},{"id":"opt-conf","label":"Conference/PD","value":"conference"},{"id":"opt-social","label":"Social Media","value":"social"},{"id":"opt-search","label":"Search Engine","value":"search"},{"id":"opt-dist","label":"District Recommendation","value":"district"}]}}},"label":"Discovery","code":"MC-DISCOVERY","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"W18JErqXh72ygRvasyuiH","type":"MC","position":{"x":720,"y":960},"data":{"screen":{"id":"W18JErqXh72ygRvasyuiH","type":"MC","title":"Daily Goal","question":"How much time can you commit daily?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}],"variableBinding":"dailyGoal","variants":{"student":{"question":"How much time can you commit to practicing each day?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]},"parent":{"question":"How much time will they be able to use Typing.com?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]},"adult":{"question":"How much time can you commit?","options":[{"id":"opt-5","label":"5 Mins","value":"5"},{"id":"opt-15","label":"15 Mins","value":"15"},{"id":"opt-30","label":"30 Mins","value":"30"}]}}},"label":"Daily Goal","code":"MC-DAILYGOAL","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"zeg0Z7OHIEWADYtj2Dy4V","type":"MSG","position":{"x":1080,"y":960},"data":{"screen":{"id":"zeg0Z7OHIEWADYtj2Dy4V","type":"MSG","title":"Goal Activated","headline":"Great commitment!","copy":"Daily Goal tracker activated. Consistency is the secret to doubling your speed.","style":"standard"},"label":"Goal Confirmed","code":"MSG-DAILYGOAL-AFF","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"lquFbGmR6lTgIZ7K5PDkp","type":"INT","position":{"x":0,"y":1280},"data":{"screen":{"id":"lquFbGmR6lTgIZ7K5PDkp","type":"INT","title":"Plan Analysis","headline":"Building Your Plan...","duration":3000,"animation":"progress-bar","messages":[{"text":"Analyzing inputs..."},{"text":"Generating curriculum..."},{"text":"Finalizing..."}],"variants":{"student":{"headline":"Building Your Plan...","messages":[{"text":"Measuring your baseline..."},{"text":"Setting target speed..."},{"text":"Optimizing curriculum..."}]},"parent":{"headline":"Building Plan...","messages":[{"text":"Assessing typing level..."},{"text":"Calibrating tech literacy modules..."},{"text":"Addressing screen time concerns..."}]},"adult":{"headline":"Building Your Plan...","messages":[{"text":"Optimizing for your goal..."},{"text":"Tackling your barriers..."},{"text":"Finalizing roadmap..."}]},"teacher":{"headline":"Building Classroom Plan...","messages":[{"text":"Confirming standards alignment..."},{"text":"Loading curriculum..."},{"text":"Configuring rostering..."}]},"school-admin":{"headline":"Building School Plan...","messages":[{"text":"Scaling for student count..."},{"text":"Securing environment..."},{"text":"Enabling data retention..."}]},"district-admin":{"headline":"Building District Plan...","messages":[{"text":"Mapping schools to dashboard..."},{"text":"Verifying rostering protocols..."},{"text":"Preparing compliance docs..."}]}}},"label":"Plan Analysis","code":"INT-PLAN-ANALYSIS","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"ttGTlLG4dnyODNm52phu5","type":"FORM","position":{"x":360,"y":1280},"data":{"screen":{"id":"ttGTlLG4dnyODNm52phu5","type":"FORM","title":"Create Account","headline":"Your Plan is Ready","copy":"Create details to save your plan.","collectFields":["email","password"],"showSocialLogin":true,"variants":{"student":{"headline":"Your customized typing plan is ready!","copy":"We''ve built a roadmap to help you reach your goal."},"parent":{"headline":"Save your child''s custom plan","copy":"We''ve generated your child''s personalized roadmap."},"adult":{"headline":"Your customized typing plan is ready!","copy":"We''ve built a roadmap to help you reach your goal."},"teacher":{"headline":"Your Classroom is Ready.","copy":"Create your free account to save your classroom settings."},"school-admin":{"headline":"Secure Your School''s Learning Environment.","copy":"Create an account to save your school''s data configuration."},"district-admin":{"headline":"Your Compliant District Plan.","copy":"Solve your privacy requirements and rostering infrastructure today."}}},"label":"Signup Form","code":"FORM-SIGNUP","isValid":true,"isSelected":false,"isHighlighted":false}},{"id":"o473wTsZysDuHqJKos0oi","type":"PAY","position":{"x":720,"y":1280},"data":{"screen":{"id":"o473wTsZysDuHqJKos0oi","type":"PAY","title":"PLUS Plan","headline":"Unlock Full Experience","valuePropositions":["Ad-free learning","Unlimited history","Certificates"],"primaryAction":{"label":"Upgrade","action":"upgrade"},"variants":{"student":{"headline":"Unlock the Full Experience","valuePropositions":["Premium Content","Zero Distractions"]},"parent":{"headline":"Unlock the Full Experience for [Child Name]","valuePropositions":["Premium Content","Zero Distractions"]},"adult":{"headline":"Your Typing.com PLUS plan is ready","valuePropositions":["Ad-free learning","Certificates","Unlimited history"]},"teacher":{"headline":"Unlock the Full Classroom Experience","valuePropositions":["Full Coding Curriculum","Ad-free environment","Student progress tracking"]},"school-admin":{"headline":"Your School''s Ad-Free Quote","valuePropositions":["100% Ad-Free Walled Garden","Unlimited Data Retention","School-wide SSO"]},"district-admin":{"headline":"Your District Implementation Roadmap","valuePropositions":["100% Ad-Free Walled Garden","Signed DPA Compliance","District Master Dashboard"]}}},"label":"Plus Paywall","code":"PAY-PLUS","isValid":true,"isSelected":false,"isHighlighted":false}}],"edges":[{"id":"e-1p4dgvlhDf48KAt8T4XUs-slNkS3fVu-zPrEipit7wR","source":"1p4dgvlhDf48KAt8T4XUs","target":"slNkS3fVu-zPrEipit7wR","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-slNkS3fVu-zPrEipit7wR-dDKs-GQT6ldAsLDmQuB05","source":"slNkS3fVu-zPrEipit7wR","target":"dDKs-GQT6ldAsLDmQuB05","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-dDKs-GQT6ldAsLDmQuB05-cpHH83eDtkpAXgMfmp1m2","source":"dDKs-GQT6ldAsLDmQuB05","target":"cpHH83eDtkpAXgMfmp1m2","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-cpHH83eDtkpAXgMfmp1m2-yUt8U3AImSVpCG4Io_bbK","source":"cpHH83eDtkpAXgMfmp1m2","target":"yUt8U3AImSVpCG4Io_bbK","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-yUt8U3AImSVpCG4Io_bbK-5adxRo7boxjBL52d26QxB","source":"yUt8U3AImSVpCG4Io_bbK","target":"5adxRo7boxjBL52d26QxB","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-5adxRo7boxjBL52d26QxB-f-sIV1P5n12Wcai1FFjwn","source":"5adxRo7boxjBL52d26QxB","target":"f-sIV1P5n12Wcai1FFjwn","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-f-sIV1P5n12Wcai1FFjwn-7DrMka7T2KWBhquDTURvq","source":"f-sIV1P5n12Wcai1FFjwn","target":"7DrMka7T2KWBhquDTURvq","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-7DrMka7T2KWBhquDTURvq-zuMd-bOIk5Rolsg1kGOqi","source":"7DrMka7T2KWBhquDTURvq","target":"zuMd-bOIk5Rolsg1kGOqi","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-zuMd-bOIk5Rolsg1kGOqi-ChrPCBxsJEcqnJXoueZqp","source":"zuMd-bOIk5Rolsg1kGOqi","target":"ChrPCBxsJEcqnJXoueZqp","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-ChrPCBxsJEcqnJXoueZqp-rui2FgUCVoTQmENPGW9l3","source":"ChrPCBxsJEcqnJXoueZqp","target":"rui2FgUCVoTQmENPGW9l3","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-rui2FgUCVoTQmENPGW9l3-TQLehiHrorIcuv4bZQCcc","source":"rui2FgUCVoTQmENPGW9l3","target":"TQLehiHrorIcuv4bZQCcc","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-TQLehiHrorIcuv4bZQCcc-DVkyPMcpTsGcyMZmW_4qW","source":"TQLehiHrorIcuv4bZQCcc","target":"DVkyPMcpTsGcyMZmW_4qW","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-DVkyPMcpTsGcyMZmW_4qW-LZogZSwjq10HfDEhyvMMS","source":"DVkyPMcpTsGcyMZmW_4qW","target":"LZogZSwjq10HfDEhyvMMS","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-LZogZSwjq10HfDEhyvMMS-W18JErqXh72ygRvasyuiH","source":"LZogZSwjq10HfDEhyvMMS","target":"W18JErqXh72ygRvasyuiH","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-W18JErqXh72ygRvasyuiH-zeg0Z7OHIEWADYtj2Dy4V","source":"W18JErqXh72ygRvasyuiH","target":"zeg0Z7OHIEWADYtj2Dy4V","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-zeg0Z7OHIEWADYtj2Dy4V-lquFbGmR6lTgIZ7K5PDkp","source":"zeg0Z7OHIEWADYtj2Dy4V","target":"lquFbGmR6lTgIZ7K5PDkp","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-lquFbGmR6lTgIZ7K5PDkp-ttGTlLG4dnyODNm52phu5","source":"lquFbGmR6lTgIZ7K5PDkp","target":"ttGTlLG4dnyODNm52phu5","type":"smoothstep","animated":true,"data":{"isDefault":true}},{"id":"e-ttGTlLG4dnyODNm52phu5-o473wTsZysDuHqJKos0oi","source":"ttGTlLG4dnyODNm52phu5","target":"o473wTsZysDuHqJKos0oi","type":"smoothstep","animated":true,"data":{"isDefault":true}}]}'::jsonb, profile_id)
  RETURNING id INTO version_id;

  -- Update Current
  UPDATE flows SET current_version_id = version_id WHERE id = new_flow_id;
END $$;

